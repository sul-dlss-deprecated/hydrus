****************
SEPTEMBER 2012
****************

--------
UI Redesign
--------

Item view page. The "Test Version" image in the top left corner interferes with
the user's ability to click the Collection hyperlink, especially when the
Collection has a very short title.

Item and Collect edit. When you click one of the "Add..." or "Delete..."
buttons, we should give the user some visual feedback so they don't think
nothing happened.

Add Item to Collection. Drop down does not work when javascript is disabled.
Applies to home page and Collection view page.

UI redesign: side bar and tabs.

Implement gated discovery: see implementation notes below.

Workflow changes and SOLR: when the workflow DS for an object changes, the
local SOLR index on a developer's box is not updated. Option 1: set up a
listener that will update local SOLR when objects changes on the dor-dev
environment. See dor-services-gem bin/ directory. Option 2: run the workflow
service locally.

--------
Technical Debt
--------

Deployment to hydrus-test.stanford.edu is a hassle. In particular, it's not easy
to get the latest fixture/file content up-to-date.

Unit tests. Can we improve our coverage in the controllers?

rightsMD: (a) tests; (b) refactor to take advantage of OM and generic_ds.rb.

Change roles: hydrus-viewer >> hydrus-collection-viewer (globally);
hydrus-item-depositor >> hydrus-collection-depositor (only at APO-Coll level).

Collection/Item create. Rather than starting a new Item/Collection with blank
text boxes, use the approach we have adopted elsewhere for non-required items:
have the user click "Add" button first. Collection: links to related items.
Item: related citations; and links to related items.

Workflow fixtures. Create proper worflow XML fixture files, and modify rake
refresh_workflows task to load the files. We need more fine-grained controlled
over the states of our fixture objects.


****************
WAITING
****************

Need a place to store Item types. Currently hardcoded to :dataset. Also see
object_type() in GenericObject. [Lynn and Hannah will discuss]

APO RELS-EXT datastream needs to add a child node to <rdf:Description>:
<hydra:referencesAgreement rdf:resource="info:fedora/druid:XXX"/>, where XXX is
the PID of the global Hydrus Agreement object. [The Hydrus agreement object
needs to be created -- need more details].

Use reified WFs rather than putting them in the APO. (a) Set up WF objects
on -dev. (b) Work with Willy to deploy the feature to -dev.

Collection create: APO.roleMetadata: set the value of <name> for the
collection-manager [waiting on LDAP].

Collection create: APO.descMetadata. Flesh out. [waiting on spec from Lynn]

Should roleMetadata have an XML namespace? If so, what should it be? Could not
find any definitive examples in Consul. [waiting on response from Lynn]

Item view page: the actions box div is called "div.collection-actions".
[Postpone this until we have GG's new design for sidebar, etc.]


****************
Implementation notes on roles and gated discovery
****************

Get APOs with which USER is involved. 
  :q 
    has_model_s                             info:fedora/afmodel:Hydrus_AdminPolicyObject
    roleMetadata_role_person_identifier_t   USER
  :fl
    identityMetadata_objectId_t             # APO druids.

For each APO:

  Get Collection governed by the APO.
    :q 
      has_model_s         info:fedora/afmodel:Hydrus_Item
      is_governed_by_s    info:fedora/druid:DRUID
    :fl
      identityMetadata_objectId_t     # Collection druid.
      title...                        # Collection title
  
  Print Collection title.

  Print the roles of USER.
    collection-manager
    collection-reviewer
    collection-viewer
    collection-depositor              # NOT item-depositor.
 
  For STATUS in [draft, waiting_approval, published]
      
    Determine N of items with STATUS
      :q 
        has_model_s          info:fedora/afmodel:Hydrus_Item
        is_governed_by_s     info:fedora/druid:DRUID
      :fq
        wf_wps_facet     (   hydrusAssemblyWF:STEP_A:completed
                         NOT hydrusAssemblyWF:STEP_B:completed)

    Generate link to those items.
