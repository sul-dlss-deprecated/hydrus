<%- @page_title = application_name -%>

<h2>Stanford Digital Repository</h2>
<p>The SDR is a service supporting long-term management of scholarly information resources at Stanford. Deposit in the SDR enables faculty, students, researchers to promote and protect the products of their work.  Librarians use the SDR to preserve and share scholarly collections of enduring value to the larger Stanford community. Through robust preservation and security measures, the repository maintains appropriate access to deposited content from persistent web links while protecting against data loss and corruption.</p>

<%- if current_user -%>
  <div class="user-collections">
    <%- if @collections.blank? -%>
      <h3>You do not have any active collections. Create a new collection below.</h3>
      <br/>
    <%- else -%>
      <h3>Your active collections</h3>
      <table class="hydrus-striped-table table-striped table-condensed">
        <thead>
          <tr>
            <th class="title">Collection</th>
            <th class="journal">Your roles</th>
            <th class="deposited">Collection items</th>
            <th class="deposited">Item status</th>
          </tr>
        </thead>
        <tbody>
        <% @collections.each do |c| %>
          <tr>
            <td><%= link_to(c.title, polymorphic_path(c)) %></td>
            <td><%= c.roles_of_person_for_ui(current_user.to_s).join(',')%></td>
            <td><%= c.hydrus_items.size %></td>
            <td><%= c.item_counts.collect {|state,num| "#{num} #{state}"}.join(', ') %></td>
          </tr> 
          <% end %>
        </tbody>
      </table>
    <%- end -%>
    <form class="form-horizontal">
			<% if can? :create, Hydrus::Collection %>
	      <%= link_to(
	            "Create a new collection", 
	            new_polymorphic_path(Hydrus::Collection),
	            :class => 'btn')  %>
				<% end %>
    </form>
  </div>

<%- else -%>
  <p>
    <%= hydrus_signin_link %>
    to view your collections
  </p>
<%- end -%>
